import React, { useRef } from "react";
import { poppins } from "@/utils/Fonts";
import Image from "next/image";
import { Button } from "@mui/material";
import RateReviewIcon from "@mui/icons-material/RateReview";
import axios from "axios";

function GiveReviewBox() {
  const hostelNames = [
    "Tagore Bhavan",
    "Bhahbha Bhavan",
    "Swami Bhavan",
    "Gajjar Bhavan",
  ];
  const chapterNames = ["GDSC", "CHRD", "LAC", "Malang", "ACM"];

  const [display, setDisplay] = React.useState(hostelNames);

  const reviewAboutRef = useRef<HTMLSelectElement | null>(null);
  const nameRef = useRef<HTMLInputElement | null>(null);
  const phoneRef = useRef<HTMLInputElement | null>(null);
  const emailRef = useRef<HTMLInputElement | null>(null);
  const selectedRef = useRef<HTMLSelectElement | null>(null);
  const messageRef = useRef<HTMLTextAreaElement | null>(null);

  const handleChange = () => {
    const value = reviewAboutRef.current?.value;
    setDisplay(value === "hostel" ? hostelNames : chapterNames);
  };

  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();

    const formData = {
      name: nameRef.current?.value,
      phone: phoneRef.current?.value,
      email: emailRef.current?.value,
      reviewAbout: reviewAboutRef.current?.value,
      selected: selectedRef.current?.value,
      message: messageRef.current?.value,
    };

    try {
      const response = await axios.post("http://localhost:3000/api/review", formData);
      console.log("Response from server:", response.data);

      // Clear form inputs
      nameRef.current!.value = "";
      phoneRef.current!.value = "";
      emailRef.current!.value = "";
      selectedRef.current!.value = "";
      messageRef.current!.value = "";
    } catch (error) {
      console.error("Error submitting review:", error);
    }
  };

  return (
    <>
      <div className="w-full m-0 p-0">
        <div className={"hidden lg:block w-10/12 mx-auto " + poppins.className}>
          <div className="flex items-center my-10">
            <RateReviewIcon style={{ fontSize: "60px" }} />
            <h1 className={"text-2xl mx-1 " + poppins.className}>
              Write Review....
            </h1>
          </div>
          <div className="w-full flex">
            {/* ... Rest of your component code ... */}
            <form className="ml-2" onSubmit={handleSubmit}>
              <ul className="flex mb-4 ">
                <ul className="flex w-7/12 items-center">
                  <li className="">Name:</li>
                  <li className="w-full mx-2">
                    <input
                      ref={nameRef}
                      type="text"
                      className="w-full border rounded-lg p-2"
                      placeholder="Enter Your Name"
                    />
                  </li>
                </ul>
                {/* ... Other form elements ... */}
              </ul>
              {/* ... Rest of your form inputs ... */}
              <Button
                type="submit"
                color="warning"
                variant="contained"
                className="bg-[#FF8345] float-right"
              >
                Submit
              </Button>
            </form>
          </div>
        </div>
      </div>
    </>
  );
}

export default GiveReviewBox;
